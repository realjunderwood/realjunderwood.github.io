<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simple React App</title>

  <link rel="stylesheet" href="react_main.css">

</head>
<body>

<div id="root"></div>


<script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
<script crossorigin src="https://unpkg.com/babel-standalone@6.26.0/babel.min.js"></script>

<!-- REACT COMPONENTS -->
<script type="text/babel" src="react_intro.js"></script>
<script type="text/babel" src="react_step1.js"></script>
<script type="text/babel" src="react_step2.js"></script>
<script type="text/babel" src="react_step2point1.js"></script>
<script type="text/babel" src="react_step2point2.js"></script>



<!-- FUNCTIONAL SCRIPTS -->
<!-- <script src="face-api.min.js"></script> -->
<script src="spotify_auth.js"></script>
 <script src="react_webcam.js"></script>




<script type="text/babel">


const accessToken = localStorage.getItem("access_token");

const clientId = 'b5ac45b92b3243668cdb8390ab51a04d';
const redirectUri = 'https://www.jamesunderwood.net/facemusic/react_main.html';

const scope = 'user-top-read playlist-modify-private ugc-image-upload';
const authUrl = new URL("https://accounts.spotify.com/authorize")

var musicGotten = false;




  // Your React code goes here

if (!localStorage.getItem("curState")) {
  localStorage.setItem("curState",0);
}


  var curState = localStorage.getItem("curState");
var toDisplay = <p></p>;

  const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get("code") && !localStorage.getItem("access_token")) { //Back from spotify
        localStorage.setItem("curState",1);
        let code = urlParams.get("code");
        let codeVerifier = localStorage.getItem('code_verifier');
        getToken(code).then((value) => {
            window.location.href = "https://www.jamesunderwood.net/facemusic/react_main.html";
        });
    }










  if (curState == 0) {
    toDisplay = (
      <React.Fragment>     
      <Reactstep1 />
      </React.Fragment>
      );
  } else {
    toDisplay = (
      <React.Fragment>     
      <Reactstep2 />
      </React.Fragment>
      );
  }





  const App = () => {
    return (
      <div>
        <Reactintro />
        <div id="postIntro">
            { toDisplay }
        </div>
      </div>
    );
  };

  ReactDOM.render(<App />, document.getElementById('root'));




  
</script>


<script>



</script>

</body>
</html>
